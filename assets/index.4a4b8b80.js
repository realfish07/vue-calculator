import{v as g,r as c,w as v,o as d,c as u,a as p,n as a,t as f,F as E,b as w,d as m,e as k}from"./vendor.849cbb6e.js";const y=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}};y();function L(e={}){const{immediate:i=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:s,onRegisterError:n}=e;let o;const l=async(h=!0)=>{};return"serviceWorker"in navigator&&(o=new g("/vue-calculator/sw.js",{scope:"/vue-calculator/"}),o.addEventListener("activated",h=>{h.isUpdate?window.location.reload():r==null||r()}),o.register({immediate:i}).then(h=>{s==null||s(h)}).catch(h=>{n==null||n(h)})),l}var A=(e,i)=>{for(const[t,r]of i)e[t]=r;return e};const x=/\d(\.\d+)?[Ee][+-]\d+/g,R={name:"App",setup(){const e=c(""),i=c(!1),t=c(null),r=c(null);return v(e,async()=>{const s=t.value;await m(),s&&s.scrollWidth>s.clientWidth&&(s.scrollLeft=s.scrollWidth-s.clientWidth)}),v(i,async()=>{const s=r.value;await m(),s&&s.scrollWidth>s.clientWidth&&(s.scrollLeft=s.scrollWidth-s.clientWidth)}),{expression:e,showResult:i,refResult:t,refExpression:r}},data:()=>({btnList:["AC","\xB1","%","\xF7","(",")","backspace","\xD7","7","8","9","-","4","5","6","+","1","2","3","=","0","."],prevExpression:"",operand:"",operator:"",result:0,showAnimation:!1,isDarkTheme:!1}),mounted(){window.addEventListener("keydown",this.detectInput)},beforeUnmount(){window.removeEventListener("keydown",this.detectInput)},methods:{removePressAnimation(e){!e.target.classList.contains("animate")||e.target.classList.remove("animate")},detectInput(e){const i=e.key.toLowerCase();if(this.btnList.includes(i)){this.pressBtn(i);return}switch(i){case"*":this.pressBtn("\xD7");break;case"/":this.pressBtn("\xF7");break;case"enter":this.pressBtn("=");break;case"escape":this.pressBtn("AC");break}},pressBtn(e){if(this.$refs[e]){for(const t of this.btnList)this.$refs[t]&&this.$refs[t].classList.remove("animate");this.$refs[e].classList.add("animate")}const i=this.showResult;if(this.showResult){if(e==="="){this.animate();return}this.result.toString()&&isFinite(this.result)?this.expression=this.result.toString():this.expression="",this.prevExpression=this.operand=this.operator="",this.result=0,this.showResult=!1}if(e==="AC"){this.prevExpression=this.operand=this.operator=this.expression="",this.result=0;return}if(e==="\xB1"){i&&(this.operand=this.expression),this.negate();return}if(e==="%"){if(i&&(this.operand=this.expression),!this.operand)return;this.operand=`${this.precise(+this.operand*.01)}`,this.expression=this.prevExpression+this.operand;return}if(e==="backspace"){if(!this.expression)return;this.backspace();return}if(e==="="){if(this.expression||(this.expression="0"),this.expression&&this.expression.match(/\(/g)){const t=this.expression.match(/\(/g).length,r=this.expression.match(/\)/g)&&this.expression.match(/\)/g).length;for(let s=0;s<t-r;s++)this.expression+=")"}this.result=this.compute(this.splitTokens()),!this.result&&this.result!==0&&(this.result="Error"),this.showResult=!0,this.animate();return}/\d|\./.test(e)?this.appendOperand(e):/\(|\)/.test(e)?this.appendParentheses(e):this.appendOperator(e)},animate(){this.showAnimation=!0,setTimeout(()=>{this.showAnimation=!1},0)},negate(){if(this.operator==="+"||this.operator==="-")this.operator=this.operator==="+"?"-":"+",this.operand&&(this.prevExpression=this.prevExpression.slice(0,-1)+this.operator);else{if(!(+this.operand||/^(-0|0)$/.test(this.operand)))return;this.operand=`${-this.operand}`}this.expression=this.prevExpression+(this.operand?this.operand:this.operator)},backspace(){let e,i,t;for(;(e=x.exec(this.expression))!==null;)i=e[0],t=x.lastIndex;t===this.expression.length?(this.operand="",this.expression=this.expression.slice(0,0-i.length)):(this.operand=this.operand.slice(0,-1),this.expression=this.expression.slice(0,-1)),/\(|\)/.test(this.expression.slice(-1))?this.prevExpression=this.expression:/[^\d\.]/.test(this.expression.slice(-1))?this.prevExpression=this.expression.slice(0,-1):(t===this.expression.length?this.operand=i:this.operand=this.expression.split(/[^\d\.]/g).filter(r=>r).slice(-1)[0]||"",this.prevExpression=this.expression.slice(0,this.operand?0-this.operand.length:0),this.prevExpression.slice(-1)==="-"&&/[^\d\.]/.test(this.prevExpression.slice(-2,-1))&&(this.operand=`-${this.operand}`,this.prevExpression=this.prevExpression.slice(0,-1))),this.operator=this.operand?this.prevExpression.slice(-1):this.expression.slice(-1),/\(|\)/.test(this.operator)&&(this.operator="")},appendParentheses(e){if(e===")"){if(this.expression&&this.expression.match(/\(/g)){const i=this.expression.match(/\(/g).length,t=this.expression.match(/\)/g)&&this.expression.match(/\)/g).length;i>t&&(this.expression=this.expression+e)}}else/\d|\)/.test(this.expression.slice(-1))&&(this.expression+="\xD7"),this.expression=this.expression+e;this.prevExpression=this.expression,this.operand=this.operator=""},appendOperand(e){if(x.test(this.operand)&&(this.operand=""),/\d|\)/.test(this.prevExpression.slice(-1))&&(this.prevExpression=this.expression),this.prevExpression.slice(-1)===")"&&(this.prevExpression+="\xD7"),/\d/.test(e))this.operand=`${+this.operand||/\.|^-$/.test(this.operand)?this.operand:this.operand==="-0"?"-":""}${e}`;else{if(/\./.test(this.operand))return;this.operand=`${/^(-|-0)$/.test(this.operand)?"-0":+this.operand}${e}`}this.expression=this.prevExpression+this.operand},appendOperator(e){this.expression||(this.prevExpression="0"),(!this.prevExpression||/[^\d\.\)]/.test(this.prevExpression.slice(-1)))&&(!this.operand&&!this.prevExpression?this.prevExpression=this.expression:Number.isNaN(+this.operand)?this.prevExpression=this.prevExpression.slice(0,-1):this.prevExpression=this.prevExpression+`${+this.operand}`),this.operand="",this.operator=e,this.expression=this.prevExpression+this.operator},splitTokens(){const e=[],i=/(\d(\.\d+)?[Ee][+-]\d+)|(([1-9]+\d*)|0)(\.\d+)?|\(|\)/g;let t,r=0,s=-1;for(;(t=i.exec(this.expression))!==null;)s!==-1&&(e.push(this.expression.slice(s,r)),s=-1),(!(t.index-1)||/[^\d]/.test(this.expression[t.index-2]))&&this.expression[t.index-1]==="-"?s=t.index-1:(r!==t.index&&e.push(this.expression.slice(r,t.index)),e.push(this.expression.slice(t.index,i.lastIndex))),s!==-1&&r!==s&&e.push(this.expression.slice(r,s)),r=i.lastIndex;const n=this.expression.slice(s!==-1?s:r);return n&&e.push(n),i.test(e[e.length-1])||e.pop(),e},compute(e){if(e.length===1)return+e[0];const i=(s,n)=>!(/\(|\)/.test(n)||/\÷|\×/.test(s)&&/\+|\-/.test(n)),t=[],r=[];for(const s of e){if(/[\d]/.test(s)){t.push(+s);continue}if(s==="("){r.push(s);continue}if(s===")"){for(;r[r.length-1]!=="(";)t.push(this.applyOp(r.pop(),t.pop(),t.pop()));r.pop();continue}for(;r.length>0&&i(s,r[r.length-1]);)t.push(this.applyOp(r.pop(),t.pop(),t.pop()));r.push(s)}for(;r.length>0;)t.push(this.applyOp(r.pop(),t.pop(),t.pop()));return t.pop()},applyOp(e,i,t){switch(t=+t,i=+i,e){case"+":return this.precise(t+i);case"-":return this.precise(t-i);case"\xD7":return this.precise(t*i);case"\xF7":return this.precise(t/i)}return 0},precise(e){const i=+e.toPrecision(8);return`${i}`.length>=8?i.toExponential():i}}},$={class:"calculator"},O={class:"switch-wrap"},P={class:"input"},T=["onPointerdown"],W={class:"btn-content"};function I(e,i,t,r,s,n){return d(),u("div",{class:a(["app-container",{"dark-theme":e.isDarkTheme,"light-theme":!e.isDarkTheme}])},[p("div",$,[p("div",O,[p("div",{class:a(["switch",{active:e.isDarkTheme,inactive:!e.isDarkTheme}]),onClick:i[0]||(i[0]=o=>e.isDarkTheme=!e.isDarkTheme)},null,2)]),p("div",P,[p("div",{ref:"refExpression",class:a(["expression",{animate:e.showAnimation}])},[p("span",null,f(r.showResult?r.expression:""),1)],2),p("div",{ref:"refResult",class:a(["result",{animate:e.showAnimation}])},[p("span",null,f(r.showResult||!r.expression?e.result:r.expression),1)],2)]),(d(!0),u(E,null,w(e.btnList,o=>(d(),u("div",{key:o,ref:o,class:a([{backspace:o==="backspace",operator:/\+|\-|\×|\÷|\=/.test(o),equal:o==="=",zero:o==="0",symbol:/[^+\-×÷=\d\.]/.test(o)},"btn"]),onPointerdown:l=>n.pressBtn(o),onTransitionend:i[1]||(i[1]=(...l)=>n.removePressAnimation&&n.removePressAnimation(...l))},[p("div",W,f(o==="backspace"?"":o),1)],42,T))),128))])],2)}var _=A(R,[["render",I]]);const B=60*60*1e3,N=L({onRegistered(e){e&&setInterval(()=>{e.update()},B)}});k(_).mount("#app");N();
