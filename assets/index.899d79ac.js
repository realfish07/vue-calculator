import{v as _,o as l,c as d,a as h,n as c,r as m,t as b,w as k,b as v,u,d as E,e as T,f as $,g,h as y,F as B,i as L,j as R,k as A}from"./vendor.cfb9d2b3.js";const I=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function s(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(t){if(t.ep)return;t.ep=!0;const o=s(t);fetch(t.href,o)}};I();function S(e={}){const{immediate:i=!1,onNeedRefresh:s,onOfflineReady:r,onRegistered:t,onRegisterError:o}=e;let n;const p=async(a=!0)=>{};return"serviceWorker"in navigator&&(n=new _("/vue-calculator/sw.js",{scope:"/vue-calculator/"}),n.addEventListener("activated",a=>{a.isUpdate?window.location.reload():r==null||r()}),n.register({immediate:i}).then(a=>{t==null||t(a)}).catch(a=>{o==null||o(a)})),p}var x=(e,i)=>{for(const[s,r]of i)e[s]=r;return e};const O={class:"switch-wrap"},D={props:{isDarkTheme:{type:Boolean,required:!0}},emits:["changeTheme"],setup(e){return(i,s)=>(l(),d("div",O,[h("div",{class:c(["switch",{active:e.isDarkTheme,inactive:!e.isDarkTheme}]),onClick:s[0]||(s[0]=r=>i.$emit("changeTheme",!e.isDarkTheme))},null,2)]))}};var P=x(D,[["__scopeId","data-v-33804518"]]);const W={class:"input"},N={props:{showAnimation:{type:Boolean,required:!0},showResult:{type:Boolean,required:!0},expression:{type:String,required:!0},result:{type:[Number,String],required:!0}},setup(e){const i=e,s=m(null),r=m(null),{expression:t,showResult:o}=b(i);return k(t,async()=>{const n=s.value;await E(),n&&n.scrollWidth>n.clientWidth&&(n.scrollLeft=n.scrollWidth-n.clientWidth)}),k(o,async()=>{const n=r.value;await E(),n&&n.scrollWidth>n.clientWidth&&(n.scrollLeft=n.scrollWidth-n.clientWidth)}),(n,p)=>(l(),d("div",W,[h("div",{ref_key:"refExpression",ref:r,class:c(["expression",{animate:e.showAnimation}])},[h("span",null,v(u(o)?u(t):""),1)],2),h("div",{ref_key:"refResult",ref:s,class:c(["result",{animate:e.showAnimation}])},[h("span",null,v(u(o)||!u(t)?e.result:u(t)),1)],2)]))}};var q=x(N,[["__scopeId","data-v-d708ea04"]]);const C={props:{btn:{type:String,required:!0}},emits:["pressBtn"],setup(e,{emit:i}){const s=e,r=m(null);T(()=>{window.addEventListener("keydown",t)}),$(()=>{window.removeEventListener("keydown",t)});function t(p){const a=p.key.toLowerCase();switch(s.btn===a&&n(),a){case"*":s.btn==="\xD7"&&n();break;case"/":s.btn==="\xF7"&&n();break;case"enter":s.btn==="="&&n();break;case"escape":s.btn==="AC"&&n();break}}function o(p){!p.target.classList.contains("animate")||p.target.classList.remove("animate")}function n(){i("pressBtn",s.btn),r.value.classList.add("animate")}return(p,a)=>(l(),d("div",{ref_key:"refBtn",ref:r,class:c([{operator:/\+|\-|\×|\÷|\=/.test(e.btn),equal:e.btn==="=",zero:e.btn==="0",symbol:/[^+\-×÷=\d\.]/.test(e.btn)},"btn"]),onPointerdown:n,onTransitionend:o},[h("div",{class:c(["btn-content",{backspace:e.btn==="backspace"}])},v(e.btn==="backspace"?"":e.btn),3)],34))}};var M=x(C,[["__scopeId","data-v-9acf1bf2"]]);const w=/\d(\.\d+)?[Ee][+-]\d+/g,F={name:"App",components:{Switch:P,Input:q,Button:M},data:()=>({btnList:["AC","\xB1","%","\xF7","(",")","backspace","\xD7","7","8","9","-","4","5","6","+","1","2","3","=","0","."],expression:"",prevExpression:"",operand:"",operator:"",result:0,showResult:!1,showAnimation:!1,isDarkTheme:!1}),mounted(){window.matchMedia&&(window.matchMedia("(prefers-color-scheme: dark)").matches&&(this.isDarkTheme=!0),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",this.changeTheme))},beforeUnmount(){window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",this.changeTheme)},methods:{changeTheme(e){this.isDarkTheme=e.matches},pressBtn(e){const i=this.showResult;if(this.showResult){if(e==="="){this.animate();return}this.result.toString()&&isFinite(this.result)?this.expression=this.result.toString():this.expression="",this.prevExpression=this.operand=this.operator="",this.result=0,this.showResult=!1}if(e==="AC"){this.prevExpression=this.operand=this.operator=this.expression="",this.result=0;return}if(e==="\xB1"){i&&(this.operand=this.expression),this.negate();return}if(e==="%"){if(i&&(this.operand=this.expression),!this.operand)return;this.operand=`${this.precise(+this.operand*.01)}`,this.expression=this.prevExpression+this.operand;return}if(e==="backspace"){if(!this.expression)return;this.backspace();return}if(e==="="){if(this.expression||(this.expression="0"),this.expression&&this.expression.match(/\(/g)){const s=this.expression.match(/\(/g).length,r=this.expression.match(/\)/g)&&this.expression.match(/\)/g).length;for(let t=0;t<s-r;t++)this.expression+=")"}this.result=this.compute(this.splitTokens()),!this.result&&this.result!==0&&(this.result="Error"),this.showResult=!0,this.animate();return}/\d|\./.test(e)?this.appendOperand(e):/\(|\)/.test(e)?this.appendParentheses(e):this.appendOperator(e)},animate(){this.showAnimation=!0,setTimeout(()=>{this.showAnimation=!1},0)},negate(){if(this.operator==="+"||this.operator==="-")this.operator=this.operator==="+"?"-":"+",this.operand&&(this.prevExpression=this.prevExpression.slice(0,-1)+this.operator);else{if(!(+this.operand||/^(-?0)$/.test(this.operand)))return;this.operand=`${-this.operand}`}this.expression=this.prevExpression+(this.operand?this.operand:this.operator)},backspace(){let e,i,s;for(;(e=w.exec(this.expression))!==null;)i=e[0],s=w.lastIndex;s===this.expression.length?(this.operand="",this.expression=this.expression.slice(0,0-i.length)):(this.operand=this.operand.slice(0,-1),this.expression=this.expression.slice(0,-1)),/\(|\)/.test(this.expression.slice(-1))?this.prevExpression=this.expression:/[^\d.]/.test(this.expression.slice(-1))?this.prevExpression=this.expression.slice(0,-1):(s===this.expression.length?this.operand=i:this.operand=this.expression.split(/[^\d.]/g).filter(r=>r).slice(-1)[0]||"",this.prevExpression=this.expression.slice(0,this.operand?0-this.operand.length:0),this.prevExpression.slice(-1)==="-"&&/[^\d.]/.test(this.prevExpression.slice(-2,-1))&&(this.operand=`-${this.operand}`,this.prevExpression=this.prevExpression.slice(0,-1))),this.operator=this.operand?this.prevExpression.slice(-1):this.expression.slice(-1),/\(|\)/.test(this.operator)&&(this.operator="")},appendParentheses(e){if(e===")"){if(this.expression&&this.expression.match(/\(/g)){const i=this.expression.match(/\(/g).length,s=this.expression.match(/\)/g)&&this.expression.match(/\)/g).length;i>s&&(this.expression=this.expression+e)}}else/\d|\)/.test(this.expression.slice(-1))&&(this.expression+="\xD7"),this.expression=this.expression+e;this.prevExpression=this.expression,this.operand=this.operator=""},appendOperand(e){if(w.test(this.operand)&&(this.operand=""),/\d|\)/.test(this.prevExpression.slice(-1))&&(this.prevExpression=this.expression),this.prevExpression.slice(-1)===")"&&(this.prevExpression+="\xD7"),/\d/.test(e))this.operand=`${+this.operand||/\.|^-$/.test(this.operand)?this.operand:this.operand==="-0"?"-":""}${e}`;else{if(/\./.test(this.operand))return;this.operand=`${/^(-|-0)$/.test(this.operand)?"-0":+this.operand}${e}`}this.expression=this.prevExpression+this.operand},appendOperator(e){this.expression||(this.prevExpression="0"),(!this.prevExpression||/[^\d.)]/.test(this.prevExpression.slice(-1)))&&(!this.operand&&!this.prevExpression?this.prevExpression=this.expression:Number.isNaN(+this.operand)?this.prevExpression=this.prevExpression.slice(0,-1):this.prevExpression=this.prevExpression+`${+this.operand}`),this.operand="",this.operator=e,this.expression=this.prevExpression+this.operator},splitTokens(){const e=[],i=/(\d(\.\d+)?[Ee][+-]\d+)|(([1-9]+\d*)|0)(\.\d+)?|\(|\)/g;let s,r=0,t=-1;for(;(s=i.exec(this.expression))!==null;)t!==-1&&(e.push(this.expression.slice(t,r)),t=-1),(!(s.index-1)||/[^\d)]/.test(this.expression[s.index-2]))&&this.expression[s.index-1]==="-"?t=s.index-1:(r!==s.index&&e.push(this.expression.slice(r,s.index)),e.push(this.expression.slice(s.index,i.lastIndex))),t!==-1&&r!==t&&e.push(this.expression.slice(r,t)),r=i.lastIndex;const o=this.expression.slice(t!==-1?t:r);return o&&e.push(o),i.test(e[e.length-1])||e.pop(),e},compute(e){if(e.length===1)return+e[0];const i=(t,o)=>!(/\(|\)/.test(o)||/÷|×/.test(t)&&/\+|-/.test(o)),s=[],r=[];for(const t of e){if(/[\d]/.test(t)){s.push(+t);continue}if(t==="("){r.push(t);continue}if(t===")"){for(;r[r.length-1]!=="(";)s.push(this.applyOp(r.pop(),s.pop(),s.pop()));r.pop();continue}for(;r.length>0&&i(t,r[r.length-1]);)s.push(this.applyOp(r.pop(),s.pop(),s.pop()));r.push(t)}for(;r.length>0;)s.push(this.applyOp(r.pop(),s.pop(),s.pop()));return s.pop()},applyOp(e,i,s){switch(s=+s,i=+i,e){case"+":return this.precise(s+i);case"-":return this.precise(s-i);case"\xD7":return this.precise(s*i);case"\xF7":return this.precise(s/i)}return 0},precise(e){const i=+e.toPrecision(8);return`${i}`.length>=8?i.toExponential():i}}},j={class:"calculator"};function U(e,i,s,r,t,o){const n=g("Switch"),p=g("Input"),a=g("Button");return l(),d("div",{class:c(["app-container",{"dark-theme":e.isDarkTheme,"light-theme":!e.isDarkTheme}])},[h("div",j,[y(n,{"is-dark-theme":e.isDarkTheme,onChangeTheme:i[0]||(i[0]=f=>e.isDarkTheme=f)},null,8,["is-dark-theme"]),y(p,{"show-animation":e.showAnimation,"show-result":e.showResult,expression:e.expression,result:e.result},null,8,["show-animation","show-result","expression","result"]),(l(!0),d(B,null,L(e.btnList,f=>(l(),R(a,{key:f,btn:f,onPressBtn:o.pressBtn},null,8,["btn","onPressBtn"]))),128))])],2)}var z=x(F,[["render",U]]);const V=60*60*1e3,K=S({onRegistered(e){e&&setInterval(()=>{e.update()},V)}});A(z).mount("#app");K();
